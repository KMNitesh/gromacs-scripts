Copied from smy_neq.
All files are updated, runtimes should be adjusted as seen fit.
